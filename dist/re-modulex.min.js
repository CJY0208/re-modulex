!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t(e.ReModulex={},e.React)}(this,function(e,t){"use strict";var o="default"in t?t.default:t,p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),y=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(e){return void 0===e},m=function(e){return e instanceof Array},u=function(e){return"string"==typeof e},b=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];try{var n=(u(t)?t.split("."):t).reduce(function(e,t){return e[t]},e);return i(n)?r:n}catch(e){return r}},g=function(e){for(var t=arguments.length,r=Array(2<t?t-2:0),n=2;n<t;n++)r[n-2]=arguments[n];var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];o=u(o)?o.split("."):o;var i=b(e,o),a=b(e,o.slice(0,-1));return"function"==typeof i?i.call.apply(i,[a].concat(r)):i},f=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return i(e)?g(t):g(e)},void 0)},O={},j=function(){return O},a=function(e,l){if(m(e)){var t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e));e=function(r){return t.reduce(function(e,t){return r[t]?v({},e,y({},t,r[t])):e},{})}}var r=f(g(e,void 0,j()),{});return Object.entries(r).reduce(function(e,t){var r=h(t,2),n=r[0],o=r[1],i=o.dispatch,a=o.commit,u=o.compute,c=o.getState;return v({},e,y({},n,f(function(){var e=c(l);return{getState:c,getComputed:function(){return u(c())},dispatch:i,commit:a,state:e,getters:u(e)}})))},{})},c=void 0,n=function(n){return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return c||console.error(new Error("\n      [ReModulex Error] \n        Forgot to apply the store?\n        Use 'ReModulex.applyStore' with your redux store!\n    ")),g.apply(void 0,[n,void 0].concat(t))}},l=function(e){c=e},w=n(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return g.apply(void 0,[c,"dispatch"].concat(t))}),x=n(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return g.apply(void 0,[c,"getState"].concat(t))}),S="Y(^_^)Y",_=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.join(S)},s=function e(t){var r,a=this,u=t.name,n=t.state,o=function(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["name","state"]);if(d(this,e),this.dispatch=function(){for(var e=arguments.length,t=Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return g.apply(void 0,[a.actions,n.split("/")].concat(t))},this.commit=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return w({type:a.name+"::"+e,payload:t})},this.compute=function(i){return Object.entries(a.getters).reduce(function(e,t){var r=h(t,2),n=r[0],o=r[1];return v({},e,y({},n,o(i)))},{})},this.getState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:x();if(e.__ReModulexName===a.name)return e;var t=b(e,a.__storeKeyCache);if(b(t,"__ReModulexName")===a.name)return t;var r=Object.entries(e).find(function(e){var t=h(e,2),r=(t[0],t[1]);return b(r,"__ReModulexName")===a.name}),n=h(r,2),o=n[0],i=n[1];return a.__storeKeyCache=o,i},O[u])throw new Error("\n        [Creating ReModulex Error] Duplicated module named '"+u+"'\n      ");if("object"!==(void 0===(r=n)?"undefined":p(r))||m(r)||null===r)throw new Error("\n        [Creating ReModulex Error] Initial state must be an Object!\n      ");var i,c,l=v({__ReModulexName:u},n),f=Object.entries(g(o,"mutations",{combine:_})).reduce(function(e,t){var r,n,o=h(t,2),i=o[0],a=o[1];return v({},e,(r=a,n=u,i.split(S).reduce(function(e,t){return v({},e,y({},n+"::"+t,r))},{})))},{}),s=g(o,"actions",{getModules:j,getStoreState:x,dispatch:this.dispatch,commit:this.commit,getState:this.getState});i=u,c=Object.assign(this,{name:u,getters:b(o,"getters",{}),actions:s,reducer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:l,t=arguments[1],r=t.type,n=t.payload;return v({},e,g(f,r,e,n))}}),O[i]=c,Object.assign(this.dispatch,s)},P={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},M={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},A=Object.defineProperty,E=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,C=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,T=N&&N(Object);var D=function e(t,r,n){if("string"==typeof r)return t;if(T){var o=N(r);o&&o!==T&&e(t,o,n)}var i=E(r);R&&(i=i.concat(R(r)));for(var a=0;a<i.length;++a){var u=i[a];if(!(P[u]||M[u]||n&&n[u])){var c=C(r,u);try{A(t,u,c)}catch(e){}}}return t},F=f(function(){try{return o.createContext()}catch(e){return console.warn(new Error("\n      [ReModulex Environment Waring] \n        'React.createContext' API is not supported by you React version. \n        So 'ModuleProvider' and 'connectModules' would NOT effect.\n        Use 'applyStore' and 'mapModules' with 'Provider' and 'connect' in react-redux instead.\n        https://github.com/CJY0208/re-modulex/blob/master/README.md#%E4%BD%BF%E7%94%A8-react-redux\n    ")),{Provider:function(e){var t=e.children;return g(t)},Consumer:function(e){var t=e.children;return g(t)}}}}),k=F.Provider,I=F.Consumer,U=function(e){function u(e){var t;d(this,u);for(var r=e.store,n=arguments.length,o=Array(1<n?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t=u.__proto__||Object.getPrototypeOf(u)).call.apply(t,[this,e].concat(o)));return a.state=a.props.store.getState(),l(r),a.unsubscibe=r.subscribe(function(){return a.setState(a.props.store.getState())}),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,t.Component),r(u,[{key:"componentWillUnmount",value:function(){g(this.unsubscibe)}},{key:"render",value:function(){return o.createElement(k,{value:this.state},this.props.children)}}]),u}();e.createModule=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(s,[null].concat(t)))},e.ModuleProvider=U,e.connectModules=function(n){return function(r){var e=function(t){return o.createElement(I,null,function(e){return o.createElement(r,v({},t,a(n,e)))})};return e.displayName="HOC-ReModulex("+f(r.displayName,r.name)+")",D(e,r)}},e.mapModules=a,e.applyStore=l,Object.defineProperty(e,"__esModule",{value:!0})});

"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),React__default=_interopDefault(React),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),defineProperty=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},objectWithoutProperties=function(e,t){var r={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},isUndefined=function(e){return void 0===e},isNull=function(e){return null===e},isFunction=function(e){return"function"==typeof e},isArray=function(e){return e instanceof Array},isObject=function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&!(isArray(e)||isNull(e))},isString=function(e){return"string"==typeof e},get$1=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];try{var n=(isString(t)?t.split("."):t).reduce(function(e,t){return e[t]},e);return isUndefined(n)?r:n}catch(e){return r}},run=function(e){for(var t=arguments.length,r=Array(2<t?t-2:0),n=2;n<t;n++)r[n-2]=arguments[n];var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];o=isString(o)?o.split("."):o;var i=get$1(e,o),a=get$1(e,o.slice(0,-1));return isFunction(i)?i.call.apply(i,[a].concat(r)):i},value=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return isUndefined(e)?run(t):run(e)},void 0)},__modules={},getModules=function(){return __modules},hasModule=function(e){return!!__modules[e]},saveModule=function(e,t){__modules[e]=t},mapModules=function(e,s){return Object.entries(value(run(e,void 0,getModules()),{})).reduce(function(e,t){var r=slicedToArray(t,2),n=r[0],o=r[1],i=o.dispatch,a=o.commit,u=o.compute,c=o.getState;return _extends({},e,defineProperty({},n,value(function(){var e=c(s);return{state:e,dispatch:i,commit:a,getters:u(e)}})))},{})},__store=void 0,check=function(n){return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return __store||console.error(new Error("\n      [ReModulex Error] \n        Forgot to apply the store?\n        Use 'ReModulex.applyStore' with your redux store!\n    ")),run.apply(void 0,[n,void 0].concat(t))}},applyStore=function(e){__store=e},dispatch=check(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return run.apply(void 0,[__store,"dispatch"].concat(t))}),getState=check(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return run.apply(void 0,[__store,"getState"].concat(t))}),__splitter="Y(^_^)Y",combine=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.join(__splitter)},split=function(e,r,n){return e.split(__splitter).reduce(function(e,t){return _extends({},e,defineProperty({},n+"::"+t,r))},{})},ReModulex=function e(t){var a=this,i=t.name,r=t.state,n=objectWithoutProperties(t,["name","state"]);if(classCallCheck(this,e),this.dispatch=function(){for(var e=arguments.length,t=Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return run.apply(void 0,[a.actions,n.split("/")].concat(t))},this.commit=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return dispatch({type:a.name+"::"+e,payload:t})},this.compute=function(i){return Object.entries(a.getters).reduce(function(e,t){var r=slicedToArray(t,2),n=r[0],o=r[1];return _extends({},e,defineProperty({},n,o(i)))},{})},this.getState=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:getState();if(e.__ReModulexName===a.name)return e;var t=get$1(e,a.__storeKeyCache);if(get$1(t,"__ReModulexName")===a.name)return t;var r=Object.entries(e).find(function(e){var t=slicedToArray(e,2),r=(t[0],t[1]);return get$1(r,"__ReModulexName")===a.name}),n=slicedToArray(r,2),o=n[0],i=n[1];return a.__storeKeyCache=o,i},hasModule(i))throw new Error("\n        [Creating ReModulex Error] Duplicated module named '"+i+"'\n      ");if(!isObject(r))throw new Error("\n        [Creating ReModulex Error] Initial state must be an Object!\n      ");var o=_extends({__ReModulexName:i},r),u=Object.entries(run(n,"mutations",{combine:combine})).reduce(function(e,t){var r=slicedToArray(t,2),n=r[0],o=r[1];return _extends({},e,split(n,o,i))},{}),c=run(n,"actions",{getModules:getModules,getStoreState:getState,dispatch:this.dispatch,commit:this.commit,getState:this.getState});saveModule(i,Object.assign(this,{name:i,getters:get$1(n,"getters",{}),actions:c,reducer:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1],r=t.type,n=t.payload;return _extends({},e,run(u,r,e,n))}})),Object.assign(this.dispatch,c)},REACT_STATICS={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},KNOWN_STATICS={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},defineProperty$1=Object.defineProperty,getOwnPropertyNames=Object.getOwnPropertyNames,getOwnPropertySymbols=Object.getOwnPropertySymbols,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,getPrototypeOf=Object.getPrototypeOf,objectPrototype=getPrototypeOf&&getPrototypeOf(Object);function hoistNonReactStatics(e,t,r){if("string"==typeof t)return e;if(objectPrototype){var n=getPrototypeOf(t);n&&n!==objectPrototype&&hoistNonReactStatics(e,n,r)}var o=getOwnPropertyNames(t);getOwnPropertySymbols&&(o=o.concat(getOwnPropertySymbols(t)));for(var i=0;i<o.length;++i){var a=o[i];if(!(REACT_STATICS[a]||KNOWN_STATICS[a]||r&&r[a])){var u=getOwnPropertyDescriptor(t,a);try{defineProperty$1(e,a,u)}catch(e){}}}return e}var hoistNonReactStatics_cjs=hoistNonReactStatics,_React$createContext=React__default.createContext(),Provider=_React$createContext.Provider,Consumer=_React$createContext.Consumer,ModuleProvider=function(e){function u(e){var t;classCallCheck(this,u);for(var r=e.store,n=arguments.length,o=Array(1<n?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a=possibleConstructorReturn(this,(t=u.__proto__||Object.getPrototypeOf(u)).call.apply(t,[this,e].concat(o)));return a.state=a.props.store.getState(),applyStore(r),a.unsubscibe=r.subscribe(function(){return a.setState(a.props.store.getState())}),a}return inherits(u,e),createClass(u,[{key:"componentWillUnmount",value:function(){run(this.unsubscibe)}},{key:"render",value:function(){return React__default.createElement(Provider,{value:this.state},this.props.children)}}]),u}(React.Component),connectModules=function(n){return function(r){var e=function(t){return React__default.createElement(Consumer,null,function(e){return React__default.createElement(r,_extends({},t,mapModules(n)))})};return e.displayName="HOC-ReModulex("+value(r.displayName,r.name)+")",hoistNonReactStatics_cjs(e,r)}},createModule=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new(Function.prototype.bind.apply(ReModulex,[null].concat(t)))};exports.createModule=createModule,exports.ModuleProvider=ModuleProvider,exports.connectModules=connectModules,exports.mapModules=mapModules,exports.applyStore=applyStore;
